# ì•„ì´ìœ ì •

## ğŸ’ ì„œë¹„ìŠ¤ ì†Œê°œ
### **"ì•„ì´ë“¤ì—ê²Œ ìœ ìµí•œ ì…ì§€ ì •ë³´ë¥¼ ì–»ê³  ì‹¶ì€ ë¶€ëª¨ë¥¼ ìœ„í•œ ë¶€ë™ì‚° ì¶”ì²œ ì„œë¹„ìŠ¤"**
ğŸ«¶ Naming : **ì•„ì´**ë“¤ì—ê²Œ **ìœ **ë¦¬í•œ ì…ì§€ **ì •**ë³´ë¥¼ ì œê³µí•˜ê² ë‹¤ëŠ” ë§ˆìŒì„ ì¤„ì„ë§ë¡œ í‘œí˜„
<br>
ê°€ì¥ ì¤‘ìš”í•œ í•™êµ°, í•™ì› ì •ë³´ë¶€í„° ì¹˜ì•ˆ(CCTV, ê²½ì°°ì„œ), êµí†µ, ë¬¸í™”, í¸ì˜ì‹œì„¤ì„ ê³ ë ¤í•´ ê±´ë¬¼ ì¸ê·¼ì˜ ì¸í”„ë¼ì— ëŒ€í•œ í†µí•© ì¶”ì²œ ì ìˆ˜ë¥¼ ì œê³µ.
<br>
- ğŸ”— LINK : https://j8e103.p.ssafy.io/ (ë°°í¬ ì¤‘)
- ğŸ¼ Period : 2023.02.27 ~ 2023.04.07 (6ì¸ 6ì£¼)
- ğŸ“‘ Notion : https://gratis-ceder-84d.notion.site/E103-6bc4a5224d6f4ad2a70471f631026a95

## âœ¨ ê¸°ëŠ¥ ë° í™”ë©´
### 1) ë©”ì¸ í˜ì´ì§€ ë° êµ¬ê¸€ ë¡œê·¸ì¸
![ë©”ì¸í˜ì´ì§€](readme_img/ë©”ì¸í˜ì´ì§€.gif)
``` bash
- ì¶”ì²œ ë‰´ìŠ¤ : ìµœê·¼ ê²€ìƒ‰ ê¸°ë¡ì„ ê¸°ë°˜ìœ¼ë¡œ ì—°ê´€ëœ í•™êµ°ì— ëŒ€í•œ ë‰´ìŠ¤ë¥¼ ì¶”ì²œ
```
<br>

### 2) ì„ í˜¸ í•„í„° ì ìš©
![ì„ í˜¸í•„í„°ì ìš©](readme_img/ì„ í˜¸í•„í„°ì ìš©.gif)

![ì§€ë„1](readme_img/ì§€ë„1.png)

![ì§€ë„2](readme_img/ì§€ë„2.png)

![ì§€ë„3](readme_img/ì§€ë„3.png)

![ì§€ë„4](readme_img/ì§€ë„4.png)

``` bash
- ì„ í˜¸ í•„í„° : í•™êµ°, êµí†µ, ë¬¸í™”, ì¹˜ì•ˆ, í¸ì˜ì‹œì„¤ ì¹´í…Œê³ ë¦¬ ë‚´ ì„¸ë¶€ì‚¬í•­ì„ ì„ íƒ
- ì¶”ì²œ ì ìˆ˜ ë§ˆì»¤ : ì§€ë„ ìœ„ ë§ˆì»¤ë¥¼ í†µí•´ í•´ë‹¹ ê±´ë¬¼(ë§¤ë¬¼)ì˜ ì¶”ì²œ ì ìˆ˜ë¥¼ í™•ì¸.
  ì¶”ì²œ ì ìˆ˜ê°€ ë†’ì„ìˆ˜ë¡ ìƒ‰ìƒì„ ì§„í•˜ê²Œ í•´ ìœ ì €ì˜ ì¸ì§€ í¸ì˜ë¥¼ ë„ì›€
- ì¶”ì²œ ì ìˆ˜ ê·¸ë˜í”„ : ë¦¬ìŠ¤íŠ¸ ë‚´ í•´ë‹¹ ê±´ë¬¼ì˜ ë¬¼ìŒí‘œë¥¼ í´ë¦­ ì‹œ ì¶”ì²œ ì ìˆ˜ì— ëŒ€í•œ ê·¼ê±° ê·¸ë˜í”„ ì œê³µ
```

<br>

### 3) ë‹¤ì–‘í•œ í•„í„°
![í•„í„°1](readme_img/í•„í„°1.png)

![í•„í„°2](readme_img/í•„í„°2.png)

![í•„í„°3](readme_img/í•„í„°3.png)

![í•„í„°4](readme_img/í•„í„°4.png)

![í•„í„°5](readme_img/í•„í„°5.png)

<br>

### 4) ê±´ë¬¼ ìƒì„¸ í˜ì´ì§€
![ìƒì„¸1](readme_img/ìƒì„¸1.png)

![ìƒì„¸2](readme_img/ìƒì„¸2.png)

![ìƒì„¸3](readme_img/ìƒì„¸3.png)

![ìƒì„¸4](readme_img/ìƒì„¸4.png)

``` bash
- ì¸í”„ë¼ ì§€ë„ : í˜„ ê±´ë¬¼(ë§¤ë¬¼) ì¸ê·¼ì˜ ì¹´í…Œê³ ë¦¬ë³„ ì£¼ë³€ ì‹œì„¤ ìœ„ì¹˜ë¥¼ í•œëˆˆì— í™•ì¸ ê°€ëŠ¥
- ì‹¤ê±°ë˜ê°€ ê·¸ë˜í”„ : ìµœê·¼ 1ë…„ì˜ ë§¤ë§¤, ì „ì„¸ ì‹¤ê±°ë˜ê°€ ê·¸ë˜í”„ ì œê³µ
- ì¸ê·¼ í•™êµ° ì •ë³´ : í˜„ ê±´ë¬¼(ë§¤ë¬¼) ìœ„ì¹˜ì—ì„œ ë‹¤ì–‘í•œ í•™êµ ë° í•™ì› ê°„ì˜ ê±°ë¦¬ ì œê³µ
```

<br>

### 5) ê´€ì‹¬ë§¤ë¬¼ í˜ì´ì§€
![ê´€ì‹¬ë§¤ë¬¼](readme_img/ê´€ì‹¬ë§¤ë¬¼.png)

<br>

## ğŸ–¥ï¸ ì‹¤í–‰ ë°©ë²•
[í¬íŒ…ë©”ë‰´ì–¼](/exec/E103_í¬íŒ…_ë©”ë‰´ì–¼.pdf) ì°¸ê³ 
### 1) ë²„ì „ ì •ë³´
```
- í˜¸ìŠ¤íŠ¸ ë¨¸ì‹ (EC2) ì„¤ì •
    - Ubuntu : `20.04.6 LTS`
    - Docker : `23.0.1`
    - Docker-compose : `1.25.0`
- Frontend ì„¤ì •
    - Node : `18.13.0`
    - npm : `9.3.1`
    - Nginx : `nginx/1.18.0 (Ubuntu)`
- Backend ì„¤ì •
    - openjdk version : `jdk-11.0.17`
    - Java(TM) SE Runtime Environment 18.9 (build 11.0.17+10-LTS-269)
    - Java HotSpot(TM) 64-Bit Server VM 18.9 (build 11.0.17+10-LTS-269, mixed mode)
    - Spring Framework : `5.3.24`
    - Spring Boot : `2.7.7`
- IDE ì„¤ì •
    - IntelliJ : `2022.3.1`
```

### 2) Dockerfile ë° docker-compose.yml ì‘ì„±
- docker-compose.yml
```bash
version: '3'

services:
        jenkins:
                image: jenkins/jenkins:lts
                container_name: jenkins
                volumes:
                        - /usr/bin/docker:/usr/bin/docker
                        - /var/run/docker.sock:/var/run/docker.sock
                        - /jenkins:/var/jenkins_home
                ports:
                        - "9090:8080"
                privileged: true
                user: root
                environment:
                        TZ: "Asia/Seoul"
        nginx:
                image: nginx:stable-alpine
                container_name: nginx
                restart: unless-stopped
                ports:
                        - "80:80"
                        - "443:443"
                volumes:
                        - ./data/nginx/nginx.conf:/etc/nginx/conf.d/nginx.conf
                        - ./data/certbot/conf:/etc/letsencrypt
                        - ./data/certbot/www:/var/www/certbot
                command: "/bin/sh -c 'while :; do sleep 6h & wait $${!}; nginx -s reload; done & nginx -g \"daemon off;\"'"
                environment:
                        TZ: "Asia/Seoul"

        certbot:
                image: certbot/certbot
                container_name: certbot
                volumes:
                         - ./data/certbot/conf:/etc/letsencrypt
                         - ./data/certbot/www:/var/www/certbot
                entrypoint: "/bin/sh -c 'trap exit TERM; while :; do certbot renew; sleep 12h & wait $${!}; done;'"
                environment:
                        TZ: "Asia/Seoul"
```

<br>

- react Dockerfile
``` bash
FROM node:16.15.0 as build-stage
COPY package.json .
RUN npm install
COPY . .
RUN npm run build

FROM nginx:stable-alpine as production-stage
COPY --from=build-stage dist /usr/share/nginx/html
EXPOSE 8080
CMD ["nginx", "-g","daemon off;"]
```

- spring boot Docker file
``` bash
FROM adoptopenjdk/openjdk11 AS builder
COPY gradlew .
COPY gradle gradle
COPY build.gradle .
COPY settings.gradle .
COPY src src
RUN chmod +x ./gradlew
RUN ./gradlew bootJAR

FROM adoptopenjdk/openjdk11
COPY --from=builder build/libs/*.jar app.jar
EXPOSE 8080
ENTRYPOINT ["sh", "-c", "java ${JAVA_ENC} ${PROFILE} -jar /app.jar"]
```
í™˜ê²½ ë³€ìˆ˜ëŠ” ì  í‚¨ìŠ¤ì—ì„œ ì£¼ì… í›„ ë¹Œë“œ ì§„í–‰
- JAVA_ENC : Jasypt ì ìš©í•œ secret key
- PROFILE : Spring bootì˜ profile í™˜ê²½

<br>

### 3) ì  í‚¨ìŠ¤ shell ì‘ì„±
``` bash
docker build -t backimg ./backend
if (docker ps | grep "backimg"); then docker stop backimg; fi
docker run -it -d --rm -p 5000:5000 -e JAVA_ENC=-Djasypt.encryptor.password=NiceE103! -e PROFILE=-Dspring.profiles.active=prod --name backimg backimg
echo "Run backend"

docker build -t frontimg ./frontend
if (docker ps | grep "frontimg"); then docker stop frontimg; fi
docker run -it -d --rm -p 8080:80 -v /home/ubuntu/deploy/nginx/front.conf:/etc/nginx/conf.d/default.conf --name frontimg frontimg
echo "Run frontend"
```

### 4) í™•ì¸
#### - mysql ì ‘ì†í•˜ì—¬ [DB ë¤í”„íŒŒì¼](/exec/E103_db_dump_20230406.sql) ì‹¤í–‰

#### - ì‹¤í–‰ì¤‘ì¸ ì»¨í…Œì´ë„ˆ í™•ì¸
``` bash
docker ps
```

<br>

## ğŸ“ ì„¤ê³„
### 1) ERD
![ERD1](readme_img/ERD1.png)

![ERD2](readme_img/ERD2.png)



### 2) ê¸°ëŠ¥ ëª…ì„¸ì„œ
![ê¸°ëŠ¥ëª…ì„¸ì„œ](readme_img/ê¸°ëŠ¥ëª…ì„¸ì„œ.png)



### 3) ì•„í‚¤í…ì²˜
![ì•„í‚¤í…ì²˜](readme_img/ì•„í‚¤í…ì²˜.png)



## ğŸ’™ íŒ€ì› ì†Œê°œ

![CRUDeveloper](readme_img/CRUDeveloper.png)
